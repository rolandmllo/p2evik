services:
    backend:
        image: backend
        build:
            context: ./backend
            dockerfile: Dockerfile
        ports:
            - "8081:8081"

        environment:
            SPRING_PROFILES_ACTIVE: dev
            SPRING_DATASOURCE_URL: jdbc:mariadb://${DB_HOST}:${DB_PORT}/${DB_DATABASE}
            SPRING_DATASOURCE_USERNAME: ${DB_USER}
            SPRING_DATASOURCE_PASSWORD: ${DB_PASSWORD}
            server.port: 8081
            server.address: 0.0.0.0
        depends_on:
            - maria-db

    maria-db:
        image: mariadb:10.6
        container_name: maria-db
        environment:
            DB_ROOT_PASSWORD: ${DB_ROOT_PASSWORD}
            DB_DATABASE: ${DB_DATABASE}
            DB_USER: ${DB_USER}
            DB_PASSWORD: ${DB_PASSWORD}
        volumes:
          - ./data:/var/lib/mysql
        ports:
            - "3306:${DB_PORT}"

volumes:
  db_data: